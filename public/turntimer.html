<html>
<head>
	<!-- BOOTSTRAP 3 -->
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" integrity="sha384-1q8mTJOASx8j1Au+a5WDVnPi2lkFfwwEAa8hDDdjZlpLegxhjVME1fgjWPGmkzs7" crossorigin="anonymous">
	<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>
	<style>
		#turnTimerBar {
			height: 30px;
			/* 			width: 50%; */
			align-self: center;
			line-height: 30px;
			margin-bottom: 20px;
			border: 2px solid #333;
		}

		#turnTimerBarChild {
			height: 30px;
			line-height: 30px;
		}
	</style>
</head>

<body style="margin: 0; padding: 0;">
	<div id="turnTimerBar" class="progress">
		<div id="turnTimerBarChild" class="progress-bar progress-bar-striped progress-bar-animated active" role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%;">0%</div>
	</div>
</body>
<script src="https://cdnjs.cloudflare.com/ajax/libs/socket.io/2.1.0/socket.io.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
<script>
	let socket = io("https://twitchplaysnintendoswitch.com", {
		path: "/8110/socket.io",
	});
	socket.on("turnTimeLeft", function(data) {
		let timeLeft = data.timeLeft;
		let turnUsername = data.username;
		let turnLength = data.turnLength;
		let lastCurrentTime = Date.now();
		let timeLeftMilli = timeLeft;
		let timeLeftSec = parseInt(timeLeft / 1000);
		let percent = parseInt((timeLeftMilli / turnLength) * 100);
		let progressBar = $(".progress-bar");

		if (turnUsername == null) {
			percent = 100;
			progressBar.css("width", percent + "%").attr("aria-valuenow", "100%").text("No one is playing right now.");
			$("#currentPlayer").text("No one is playing right now.");
		} else {
			progressBar.css("width", percent + "%").attr("aria-valuenow", percent + "%").text(data.username + ": " + timeLeftSec + " seconds");
			$("#currentPlayer").text("Current Player: " + turnUsername);
		}
	});
</script>
</html>